"use strict";(self.webpackChunkvue3_antd_admin=self.webpackChunkvue3_antd_admin||[]).push([[7363,9484],{10273:function(e,a,n){n.a(e,(async function(e,l){try{n(38049);var t=n(62282),u=(n(12431),n(66900)),i=(n(92649),n(16751)),o=(n(6788),n(97139)),s=(n(49282),n(47297)),r=(n(5378),n(72616)),c=(n(94310),n(61446)),d=n(66252),v=n(2262),m=n(3577),w=n(79697),h=n(98243),p=n(4804),f=n(9525),y=n(66827),g=e([f,y]);[f,y]=g.then?(await g)():g;const S=(0,d.Uk)("更新"),k=(0,d.aZ)({name:"FilePreviewDrawer"});a.Z=(0,d.aZ)({...k,setup(e,a){let{expose:n}=a;const l=new Map([["name","文件名"],["mimeType","文件类型"],["hash","文件Hash"],["md5","文件MD5"],["fsize","文件大小"],["putTime","上传时间"],["uploader","上传人员"]]),g=(0,v.iH)(!1),k=(0,v.iH)(!1),U=(0,v.iH)(""),Z=(0,v.iH)(""),A=(0,v.iH)({}),b=(0,v.iH)(""),M=(0,v.iH)(""),I=(0,v.iH)(!1),R=(0,d.Fl)((()=>(0,w.Z)(b.value))),W=(0,d.Fl)((()=>`${b.value}?imageView2/2/w/500/h/210`)),C=async()=>{try{I.value=!0,await f.n0({name:U.value,path:Z.value,mark:M.value}),c.ZP.success("已更新文件备注")}finally{I.value=!1}},H=()=>{U.value="",Z.value="",b.value="",M.value="",A.value={},k.value=!1};return n({open:(e,a)=>{k.value=!0,U.value=e,Z.value=a,(0,d.Y3)((async()=>{try{g.value=!0;const n={name:e,path:a},t=await f.E9(n);if(M.value=t.mark,Array.from(l.keys()).forEach((e=>{"fsize"===e?A.value.fsize=(0,h.GR)(t[e]):A.value[e]=t[e]})),A.value.name=e,(0,y.RA)("netdisk.manage.download")&&t.mimeType.includes("image/")){const e=await f.Sv(n);b.value=e}}catch{H()}finally{g.value=!1}}))}}),(e,a)=>{const n=(0,d.up)("a-button");return(0,d.wg)(),(0,d.j4)((0,v.SU)(r.Z),{title:"文件详情",width:500,visible:k.value,onClose:H},{default:(0,d.w5)((()=>[(0,d.Wm)((0,v.SU)(s.Z),{spinning:g.value,class:"preview-drawer-inner-box"},{default:(0,d.w5)((()=>[(0,d.Wm)((0,v.SU)(o.Z),{direction:"vertical"},{default:(0,d.w5)((()=>[(0,d.Wm)((0,v.SU)(i.ZP),{style:(0,m.j5)({width:(0,v.SU)(R)?"130px":"100%",height:(0,v.SU)(R)?"85px":"210px"}),src:(0,v.SU)(R)?(0,v.SU)(p):(0,v.SU)(W),preview:!(0,v.SU)(R)&&{src:b.value}},null,8,["style","src","preview"]),(0,d.Wm)((0,v.SU)(u.ZP),{bordered:"",column:1},{default:(0,d.w5)((()=>[((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)((0,v.SU)(l).keys(),(e=>((0,d.wg)(),(0,d.j4)((0,v.SU)(u.ZP).Item,{key:e,label:(0,v.SU)(l).get(e)},{default:(0,d.w5)((()=>[(0,d.Uk)((0,m.zw)(A.value[e]),1)])),_:2},1032,["label"])))),128)),(0,d.Wm)((0,v.SU)(u.ZP).Item,{label:"文件备注"},{default:(0,d.w5)((()=>[(0,d.Wm)((0,v.SU)(o.Z),{direction:"vertical",align:"end"},{default:(0,d.w5)((()=>[(0,d.Wm)((0,v.SU)(t.ZP).TextArea,{value:M.value,"onUpdate:value":a[0]||(a[0]=e=>M.value=e),disabled:!e.$auth("netdisk.manage.mark"),placeholder:"请输入文件备注",maxlength:100,rows:4,"show-count":""},null,8,["value","disabled"]),(0,d.Wm)(n,{loading:I.value,disabled:!e.$auth("netdisk.manage.mark"),type:"primary",size:"mini",onClick:C},{default:(0,d.w5)((()=>[S])),_:1},8,["loading","disabled"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["spinning"])])),_:1},8,["visible"])}}}),l()}catch(e){l(e)}}))},2746:function(e,a,n){n.a(e,(async function(e,l){try{n(49063);var t=n(4197),u=(n(38770),n(47346)),i=(n(6788),n(97139)),o=(n(84324),n(95878)),s=n(66252),r=n(2262),c=n(3577),d=n(99678),v=n(79697),m=n(3446),w=n(20030),h=n(59484),p=n(19242),f=n(9525),y=n(98243),g=n(15808),S=n(64520),k=n(66827),U=n(21502),Z=e([m,w,h,f,g,k,U]);[m,w,h,f,g,k,U]=Z.then?(await Z)():Z;const A=(0,s.Uk)("根目录"),b=["innerHTML"],M={key:1},I=(0,s.aZ)({name:"NetDiskManage"});a.Z=(0,s.aZ)({...I,setup(e){const[a,n]=(0,U.useTable)(),[l]=(0,g.U8)(),{columns:Z,currentPathList:I,localSearchKey:R,isSearching:W}=(0,h.useColumns)(),C=(0,r.iH)(),H=(0,r.iH)([]),x=(0,r.iH)(""),E=(0,r.iH)(!1),P=(0,r.iH)(!1),D=(0,r.iH)(!1),Q=(0,r.iH)(!1),T=(0,r.iH)([]),z=(0,r.qj)({selectedRowKeys:[],onChange:(e,a)=>{z.selectedRowKeys=e,T.value=a.map((e=>({type:e.type,name:e.name})))}}),B=(0,s.Fl)((()=>(0,v.Z)(x.value))),F=()=>{let e="";return I.value.length>0&&(e=`${I.value.join("/")}/`),e},L=e=>{E.value!==e&&(E.value=e)},j=()=>{x.value=" ",H.value=[],T.value=[],Q.value&&(Q.value=!1),q()},q=async()=>{var e;if(Q.value)return;P.value=!0,Q.value=!0;const a=F(),n=await f.DR({path:a,key:R.value,marker:(null===(e=x.value)||void 0===e?void 0:e.trim())||""}).finally((()=>P.value=!1));if((0,v.Z)(x))H.value=n.list||[];else{const e=n.list.filter((e=>"file"===e.type||!H.value.find((a=>"file"!==a.type&&a.name===e.name))));(0,v.Z)(e)||H.value.push(...e)}x.value=n.marker,Q.value=!1},J=e=>{W.value||(-1===e&&I.value.length>0?I.value=[]:e>=0&&I.value.length-1!==e&&(I.value=I.value.slice(0,e+1)))},K=e=>({onContextmenu:a=>{(0,S.createContextMenu)({event:a,items:[{label:"下载",disabled:"dir"===e.type||!(0,k.RA)("netdisk.manage.download"),handler:()=>{(async e=>{try{D.value=!0;const a=await f.Sv({path:F(),name:e.name});window.open(`${a}?attname=${encodeURIComponent(e.name)}`)}finally{D.value=!1}})(e)}},{label:"重命名",disabled:!(0,k.RA)("netdisk.manage.rename"),handler:()=>{(async e=>{await l({modalProps:{title:"重命名",width:700,onFinish:async a=>{await f.gQ({type:e.type,toName:a.toName,name:e.name,path:F()}),j()}},formProps:{labelWidth:100,schemas:(0,p.getRenameSchemas)(e)}})})(e)}}]})}});return(0,s.YP)([I,R],(()=>{j()}),{deep:!0}),(0,s.bv)((()=>{q(),n.onInfiniteScroll((()=>{B.value||q()}))})),(e,n)=>{const l=(0,s.up)("svg-icon");return(0,s.wg)(),(0,s.j4)((0,r.SU)(o.ZP),{class:"h-full"},{title:(0,s.w5)((()=>[(0,s.Wm)((0,r.SU)(i.Z),null,{default:(0,s.w5)((()=>[(0,s.Wm)((0,r.SU)(d.Z)),(0,s.Wm)((0,r.SU)(u.ZP),null,{default:(0,s.w5)((()=>[(0,s.Wm)((0,r.SU)(u.ZP).Item,null,{default:(0,s.w5)((()=>[(0,s.Wm)((0,r.SU)(t.ZP).Link,{onClick:n[0]||(n[0]=e=>J(-1))},{default:(0,s.w5)((()=>[A])),_:1})])),_:1}),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,r.SU)(I),((e,a)=>((0,s.wg)(),(0,s.j4)((0,r.SU)(u.ZP).Item,{key:a},{default:(0,s.w5)((()=>[(0,s.Wm)((0,r.SU)(t.ZP).Link,{onClick:e=>J(a)},{default:(0,s.w5)((()=>[(0,s.Uk)((0,c.zw)(e),1)])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1})])),_:1})])),extra:(0,s.w5)((()=>[(0,s.Wm)(m.default,{"search-key":(0,r.SU)(R),"onUpdate:search-key":n[1]||(n[1]=e=>(0,r.dq)(R)?R.value=e:null),"selected-file-list":T.value,"update-operate-status":L,"parse-path":F,onChanged:j},null,8,["search-key","selected-file-list"])])),default:(0,s.w5)((()=>[(0,s.Wm)((0,r.SU)(a),{"data-source":H.value,columns:(0,r.SU)(Z),"custom-row":K,"auto-height":!0,pagination:!1,search:!1,"show-tool-bar":!1,loading:P.value,"row-selection":z},{bodyCell:(0,s.w5)((a=>{let{column:n,record:u}=a;return["name"===n.key?((0,s.wg)(),(0,s.j4)((0,r.SU)(t.ZP).Link,{key:0,disabled:"file"===u.type&&!e.$auth("netdisk.manage.info"),onClick:e=>(e=>{var a,n;if("dir"===e.type)if(W.value){const a=(0,v.Z)(e.belongTo)?[]:e.belongTo.split("/");a.push(e.name),R.value="",I.value=a}else I.value.push(e.name);else W.value?null===(a=C.value)||void 0===a||a.open(e.name,(0,v.Z)(e.belongTo)?"":`${e.belongTo}/`):null===(n=C.value)||void 0===n||n.open(e.name,F())})(u)},{default:(0,s.w5)((()=>[(0,s.Wm)((0,r.SU)(i.Z),null,{default:(0,s.w5)((()=>{return[(0,s.Wm)(l,{name:(a=u.name,n=u.type,"dir"===n?"file-type-dir":(0,y.IS)(a))},null,8,["name"]),(0,r.SU)(W)?((0,s.wg)(),(0,s.iD)("span",{key:0,innerHTML:(e=u.name,e.replace(new RegExp(`${R.value}`,"g"),`<span style='color: red;'>${R.value}</span>`))},null,8,b)):((0,s.wg)(),(0,s.iD)("span",M,(0,c.zw)(u.name),1))];var e,a,n})),_:2},1024)])),_:2},1032,["disabled","onClick"])):(0,s.kq)("",!0)]})),_:1},8,["data-source","columns","loading","row-selection"]),(0,s.Wm)(w.default,{ref_key:"previewDrawerRef",ref:C},null,512)])),_:1})}}}),l()}catch(e){l(e)}}))},59484:function(e,a,n){n.a(e,(async function(e,l){try{n.r(a),n.d(a,{useColumns:function(){return d}});var t=n(66252),u=n(2262),i=n(79697),o=n(98243),s=n(66827),r=e([s]);s=(r.then?(await r)():r)[0];const c=e=>e?(0,o.GR)(e):"-",d=()=>{const e=(0,u.iH)([]),a=(0,u.iH)(""),n=(0,t.Fl)((()=>!(0,i.Z)(a.value))),l=(0,t.Fl)((()=>[{title:"文件名",dataIndex:"name"},{title:"大小",width:120,align:"center",dataIndex:"fsize",customRender:e=>{let{record:a}=e;return(0,t.Wm)("span",null,[c(a.fsize)])}},{title:"上传时间",dataIndex:"putTime",align:"center",width:220},{title:"所属目录",dataIndex:"belongTo",align:"center",width:220,hideInTable:!n.value,customRender:e=>{let{record:a}=e;return(0,t.Wm)((0,t.up)("a-button"),{type:"link",disabled:"file"===a.type&&!(0,s.RA)("netdisk.manage.info"),onClick:()=>o(a)},{default:()=>[a.belongTo?a.belongTo:"根目录"]})}}])),o=n=>{a.value="",(0,i.Z)(n.belongTo)?e.value=[]:e.value=n.belongTo.split("/")};return{columns:l,currentPathList:e,localSearchKey:a,isSearching:n}};l()}catch(e){l(e)}}))},20030:function(e,a,n){n.a(e,(async function(e,l){try{n.r(a);var t=n(74359),u=e([t]);const i=(t=(u.then?(await u)():u)[0]).Z;a.default=i,l()}catch(e){l(e)}}))},17363:function(e,a,n){n.a(e,(async function(e,l){try{n.r(a);var t=n(44248),u=e([t]);const i=(t=(u.then?(await u)():u)[0]).Z;a.default=i,l()}catch(e){l(e)}}))},74359:function(e,a,n){n.a(e,(async function(e,l){try{n.d(a,{Z:function(){return t.Z}});var t=n(10273),u=e([t]);t=(u.then?(await u)():u)[0],l()}catch(e){l(e)}}))},44248:function(e,a,n){n.a(e,(async function(e,l){try{n.d(a,{Z:function(){return t.Z}});var t=n(2746),u=e([t]);t=(u.then?(await u)():u)[0],l()}catch(e){l(e)}}))},4804:function(e){e.exports="data:image/png;base64,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"}}]);